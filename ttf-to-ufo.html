<!DOCTYPE html>
<html lang="en">
<head>
        <title>Eli Heuerâ€™s Blog</title>
    <meta charset="utf-8" />
    <meta name=viewport content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="https://elih.blog/theme/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
    <link rel="stylesheet" href="//basehold.it/37.5/255/0/0">

        <meta name="tags" content="Python" />
        <meta name="tags" content="Defcon" />
</head>

<div class="wrapper" id="baseline">

    <div class="header">
        <h1><a href="https://elih.blog/">Eli Heuerâ€™s Blog</a></h1>
    </div>

<div class="content">
    <header>
        <hr>
        <h2 id="article-header" class="entry-title">Building a TTF to UFO Converter with Argparse</h2>
        
    </header>
    <footer class="post-info">
    <time class="published-post" datetime="2018-01-23T00:00:00-05:00">
      January 23, 2018
    </time>
  </footer>
  <div class="article-content">
    <p>If you have used command line software before you are probably familiar with flags, for example <code>--help</code> for help or <code>-v</code> for version. In this tutorial, I will demonstrate using the module <strong>argparse</strong> to add flags to a Python script.</p>
<p>The script will convert a TTF font file to a <a class="reference external" href="https://github.com/unified-font-object">UFO</a> directory, UFO is an XML based format used for uncompiled fonts. To start, open a terminal and navigate to a directory where you want to work. To make a virtual environment that will keep dependancies contained, enter the following commands:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 -m venv ttf2ufo
ðŸ‘‰ cd ttf2ufo
ðŸ‘‰ source bin/activate
ðŸ‘‰ mkdir working
ðŸ‘‰ cd working
</pre></div>
<p>Runnging <code>source bin/activate</code> activates the virtual environment, to deactivate simply enter <code>deactivate</code>. Now that we are in the <code>venv</code> we need to install the packages needed for the script, <strong>argparse</strong>, <strong>defcon</strong> and, <strong>ufo-extractor</strong>:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="https://pypi.python.org/pypi/ufo-extractor">ufo-extractor</a>: Extracts UFO files from defcon font objects.</div>
<div class="line"><a class="reference external" href="https://pypi.python.org/pypi/defcon/0.3.5">defcon</a>: Creates a Python object from a given TTF.</div>
<div class="line"><a class="reference external" href="https://pypi.python.org/pypi/argparse/1.4.0">argparse</a>: Command line interface tool, gets input and output location.</div>
</div>
<p>Install these dependencies with <strong>pip</strong>:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ pip install --upgrade ufo-extractor defcon argparse
</pre></div>
<p>Now we have everything installed and are ready to write the script, in the <code>ttf2ufo/working/</code> directory, make a new Python file and open it with a text editor(Nano, emacs, etc...):</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ touch ttf-to-ufo.py
ðŸ‘‰ emacs ttf-to-ufo.py
</pre></div>
<p>Now start the script by importing <code>argparse</code>, make a new <strong>argparse</strong> object called parser and call <code>parser.parse_args()</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</pre></div>
<p>Save the script an run it from the command line:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 ttf-to-ufo.py
</pre></div>
<p>Nothing happens... try running it with a <code>--help</code> flag:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 ttf-to-ufo.py --help

usage: test.py [-h]

optional arguments:
-h, --help  show this help message and exit
</pre></div>
<p>It works, great. Help is the only built-in flag that works without additional code, so letâ€™s add <code>-i</code> for input path and <code>-o</code> for output path:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span> <span class="o">=</span> <span class="s2">&quot;input file path&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">help</span> <span class="o">=</span> <span class="s2">&quot;output file path&quot;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;inputfile:&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;outputfile:&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">o</span><span class="p">)</span>
</pre></div>
<p>Now if we run the script with a help flag again, we should get something like this:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 ttf-to-ufo.py --help

usage: test.py [-h] [-i I] [-o O]

optional arguments:
-h, --help  show this help message and exit
-i I        input file path
-o O        output file path
</pre></div>
<p>Next, letâ€™s try using the flags, replace <code>~/.fonts/test.ttf</code> with the path to a TTF you want to use:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 ttf-to-ufo.py -i ~/.fonts/test.ttf -o test.ufo
inputfile: /home/user/.fonts/test.ttf
outputfile: test.ufo
</pre></div>
<p>Now import <strong>defcon</strong> and <strong>ufo-extractor</strong>. Please note that even though <strong>ufo-extractor</strong> is imported with <code>pip install ufo-extractor</code>, it needs to be imported in python with <code>import extractor</code>, confusing, I know. Move the <strong>argparse</strong> code into a function that returns args and move the script part into a conditional statement. <code>if __name__ == &quot;__main__&quot;:</code> tells Python to only run the script part when you are running the script from the command line, and ignore it if you are importing <code>create_arg_parser</code> into another Python program:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">defcon</span>
<span class="kn">import</span> <span class="nn">extractor</span>

<span class="k">def</span> <span class="nf">create_arg_parser</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span> <span class="o">=</span> <span class="s2">&quot;input filename&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">help</span> <span class="o">=</span> <span class="s2">&quot;output filename&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">args</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">create_arg_parser</span><span class="p">()</span>
    <span class="n">ttf_path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">i</span>
    <span class="n">ufo_path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">o</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ttf_path: &#39;</span><span class="p">,</span> <span class="n">ttf_path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ufo_path:&#39;</span><span class="p">,</span> <span class="n">ufo_path</span><span class="p">)</span>
    <span class="c1"># Make UFO</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Generating UFO...&#39;</span><span class="p">,</span> <span class="n">ufo_path</span><span class="p">)</span>
    <span class="n">ufo</span> <span class="o">=</span> <span class="n">defcon</span><span class="o">.</span><span class="n">Font</span><span class="p">()</span>
    <span class="n">extractor</span><span class="o">.</span><span class="n">extractUFO</span><span class="p">(</span><span class="n">ttf_path</span><span class="p">,</span> <span class="n">ufo</span><span class="p">)</span>
    <span class="n">ufo</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">ufo_path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Done.&#39;</span><span class="p">)</span>
</pre></div>
<p>If you run this script with <code>-i</code> and <code>-o</code> a UFO directory should be generated. If you donâ€™t give a full file path for <code>-o</code> and just enter a file name like this <code>test.ufo</code>, a ufo directory will be created in the same directory as the script:</p>
<div class="highlight"><pre><span></span>ðŸ‘‰ python3 ttf-to-ufo.py -i ~/.fonts/test.ttf -o ~/test.ufo
ttf_path:  /home/eli/.fonts/test.ttf
ufo_path: /home/eli/test.ufo
Generating UFO... /home/eli/test.ufo
Done.
</pre></div>

  </div>
</div>

    <div class="contact">
        <hr>
        <h3>Contact</h3>
        <ul>
            <li><a href="https://mastodon.social/users/elih">Mastodon</a></li>
            <li><a href="https://twitter.com/eliheuer">Twitter</a></li>
            <li><a href="https://github.com/eliheuer">GitHub</a></li>
            <li><a href="mailto:elih@protonmail.com?Subject=Hello">Email</a></li>
            <li><a href="https://www.youtube.com/user/eliheuer/videos">YouTube</a></li>
            <li><a href="https://www.instagram.com/elih.photos/">Instagram</a></li>
            <li><a href="https://www.twitch.tv/elih">Twitch</a></li>
        </ul>
    </div>

    <div class="tags" id="box">
        <hr><a href="https://elih.blog/tags"><h3>Tags</h3></a><ul>
            <li><a href="https://elih.blog/tag/math">Math</a></li>
            <li><a href="https://elih.blog/tag/rust">Rust</a></li>
            <li><a href="https://elih.blog/tag/python">Python</a></li>
            <li><a href="https://elih.blog/tag/arabic">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a></li>
            <li><a href="https://elih.blog/tag/trufont">TruFont</a></li>
            <li><a href="https://elih.blog/tag/ufo">UFO</a></li>
            <li id="margin-bottom"><a href="https://elih.blog/tag/calligraphy">Calligraphy</a></li>
        </ul>
    </div>

    <div class="source-code" id="box">
        <hr>
        <h3>Source Code</h3>
        <p class="site-footer__type">This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which is built with <a href="http://python.org">Python</a>. The theme is on GitHub <a href="https://github.com/eliheuer/pelican-elis-theme">here</a> and the uncompiled content is <a href="https://github.com/eliheuer/blog">here</a>.</p>
    </div>

    <div class="licensing" id="box">
        <hr>
        <h3>Licensing</h3>
        <p>Except where otherwise noted,
            content on this site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International
        <a href="https://creativecommons.org/licenses/by-sa/4.0/">(CC_BY-SA 4.0)</a> license.</p>
        <p>Except where otherwise noted,
            all source code on this blog is licensed under the
            <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPLv3</a> License.</p>
        <p>&copy; 2018</p>
    </div>

    <div class="feeds">
      <hr>
      <h3>Feeds</h3>
      <!-- <p><a href="https://elih.blog/feeds/all.atom">RSS</a></p> -->
      <p><a href="https://elih.blog/feeds/all.atom">Atom</a></p>
    </div>

    <div class="software">
        <div class="software__icon">
	    <img src="https://elih.blog/images/tux-linux.gif" alt="Tux">
	</div>
	<p>This site was built with GNU Emacs running on Arch Linux.</p>
    </div>

</div>
</body>
</html>